<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Oracle: 2026 Destiny Analysis</title>
    
    <!-- React & Tailwind CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@300;500;700&family=Pretendard:wght@300;400;600&display=swap');

        body {
            background-color: #050505;
            color: #e0ffe0;
            font-family: 'Pretendard', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .font-serif { font-family: 'Noto Serif KR', serif; }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(20, 30, 20, 0.65);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(100, 255, 150, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 20, 10, 0.5);
        }

        .glass-input {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(100, 255, 150, 0.2);
            color: #ccffcc;
        }
        .glass-input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
        }

        .glass-btn {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 100, 50, 0.2) 100%);
            border: 1px solid rgba(0, 255, 136, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .glass-btn:hover {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.3) 0%, rgba(0, 100, 50, 0.4) 100%);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
            transform: translateY(-2px);
        }

        /* Animations */
        .aurora-bg {
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, rgba(0, 255, 136, 0.08), transparent 40%),
                        radial-gradient(circle at 80% 20%, rgba(0, 100, 255, 0.05), transparent 40%);
            animation: rotate 20s linear infinite;
            z-index: -1;
            pointer-events: none;
        }
        @keyframes rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .fade-in { animation: fadeIn 0.8s ease-in forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .glow-text { text-shadow: 0 0 10px rgba(0, 255, 136, 0.7); }

        .orb {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(200, 255, 220, 0.8), rgba(0, 255, 136, 0.4), rgba(0, 50, 20, 0));
            box-shadow: 0 0 60px rgba(0, 255, 136, 0.5);
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); filter: hue-rotate(0deg); }
            50% { transform: translateY(-20px) scale(1.05); filter: hue-rotate(20deg); }
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #005533; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #00ff88; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Constants ---
        const CELESTIAL_STEMS = ["ê°‘(ç”²)", "ì„(ä¹™)", "ë³‘(ä¸™)", "ì •(ä¸)", "ë¬´(æˆŠ)", "ê¸°(å·±)", "ê²½(åºš)", "ì‹ (è¾›)", "ì„(å£¬)", "ê³„(ç™¸)"];
        const EARTHLY_BRANCHES = ["ì(å­)", "ì¶•(ä¸‘)", "ì¸(å¯…)", "ë¬˜(å¯)", "ì§„(è¾°)", "ì‚¬(å·³)", "ì˜¤(åˆ)", "ë¯¸(æœª)", "ì‹ (ç”³)", "ìœ (é…‰)", "ìˆ (æˆŒ)", "í•´(äº¥)"];
        const FIVE_ELEMENTS = {
            "ç”²": "wood", "ä¹™": "wood", "å¯…": "wood", "å¯": "wood",
            "ä¸™": "fire", "ä¸": "fire", "å·³": "fire", "åˆ": "fire",
            "æˆŠ": "earth", "å·±": "earth", "è¾°": "earth", "æˆŒ": "earth", "ä¸‘": "earth", "æœª": "earth",
            "åºš": "metal", "è¾›": "metal", "ç”³": "metal", "é…‰": "metal",
            "å£¬": "water", "ç™¸": "water", "äº¥": "water", "å­": "water"
        };
        const ELEMENT_NAMES = { wood: "ëª©(æœ¨)", fire: "í™”(ç«)", earth: "í† (åœŸ)", metal: "ê¸ˆ(é‡‘)", water: "ìˆ˜(æ°´)" };
        const MBTI_TYPES = ["ISTJ", "ISFJ", "INFJ", "INTJ", "ISTP", "ISFP", "INFP", "INTP", "ESTP", "ESFP", "ENFP", "ENTP", "ESTJ", "ESFJ", "ENFJ", "ENTJ"];
        const MBTI_TRAITS = {
            "ISTJ": { strength: "ì±…ì„ê°ê³¼ ì² ì €í•¨", weakness: "ì˜ˆê¸°ì¹˜ ëª»í•œ ë³€í™”ì— ëŒ€í•œ ìŠ¤íŠ¸ë ˆìŠ¤", behavior: "ê³„íšëŒ€ë¡œ ì§„í–‰í•˜ë ¤ëŠ” ì„±í–¥" },
            "ISFJ": { strength: "ì„±ì‹¤í•¨ê³¼ ë°°ë ¤ì‹¬", weakness: "ê±°ì ˆí•˜ì§€ ëª»í•´ ìŒ“ì´ëŠ” í”¼ë¡œ", behavior: "íƒ€ì¸ì„ ë•ëŠë¼ ìì‹ ì„ í¬ìƒí•˜ëŠ” ê²½í–¥" },
            "INFJ": { strength: "ê¹Šì€ í†µì°°ë ¥ê³¼ ì§ê´€", weakness: "í˜„ì‹¤ì ì¸ ì‹¤í–‰ë ¥ ë¶€ì¡±", behavior: "ì˜ë¯¸ë¥¼ ì°¾ê¸° ìœ„í•´ ê¹Šê²Œ ê³ ë¯¼í•˜ëŠ” íƒœë„" },
            "INTJ": { strength: "ê±°ì‹œì ì¸ ì „ëµì  ì‚¬ê³ ", weakness: "íƒ€ì¸ì˜ ê°ì •ì— ëŒ€í•œ ë¬´ê´€ì‹¬", behavior: "íš¨ìœ¨ì„±ì„ ìœ„í•´ ê°ì •ì„ ë°°ì œí•˜ëŠ” ì„±í–¥" },
            "ISTP": { strength: "ìƒí™© ì ì‘ë ¥ê³¼ ê¸°ìˆ ", weakness: "ì§€ë£¨í•¨ì„ ëª» ê²¬ë””ëŠ” ì¶©ë™ì„±", behavior: "ì¦‰í¥ì ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ëŠ” ì„±í–¥" },
            "ISFP": { strength: "ì˜¨í™”í•¨ê³¼ ì˜ˆìˆ ì  ê°ê°", weakness: "ê°ˆë“± ìƒí™© íšŒí”¼", behavior: "í˜„ì¬ì˜ ê°ì •ì— ì¶©ì‹¤í•œ íƒœë„" },
            "INFP": { strength: "ìˆœìˆ˜í•œ ì—´ì •ê³¼ ì°½ì˜ì„±", weakness: "í˜„ì‹¤ì ì¸ ê²½ì œ ê´€ë… ë¶€ì¡±", behavior: "ìì‹ ì˜ ê°€ì¹˜ê´€ì— ë”°ë¼ ì›€ì§ì´ëŠ” ì„±í–¥" },
            "INTP": { strength: "ë…¼ë¦¬ì  ë¶„ì„ë ¥", weakness: "ì‹¤í–‰ë³´ë‹¤ ìƒê°ì´ ë„ˆë¬´ ë§ìŒ", behavior: "ì´ë¡ ì  ì™„ë²½í•¨ì„ ì¶”êµ¬í•˜ëŠ” íƒœë„" },
            "ESTP": { strength: "ëŒ€ë‹´í•¨ê³¼ í–‰ë™ë ¥", weakness: "ì¥ê¸°ì ì¸ ì•ˆëª© ë¶€ì¡±", behavior: "ìœ„í—˜ì„ ê°ìˆ˜í•˜ê³  ë›°ì–´ë“œëŠ” ì„±í–¥" },
            "ESFP": { strength: "ë‚™ì²œì„±ê³¼ ì‚¬êµì„±", weakness: "ì§„ì§€í•œ ìƒí™©ì—ì„œì˜ ì§‘ì¤‘ë ¥ ë¶€ì¡±", behavior: "ì¦ê±°ì›€ì„ ìµœìš°ì„ ìœ¼ë¡œ ë‘ëŠ” íƒœë„" },
            "ENFP": { strength: "í’ë¶€í•œ ìƒìƒë ¥ê³¼ ì—´ì •", weakness: "ë§ˆë¬´ë¦¬ê°€ ì•½í•˜ê³  ì‚°ë§Œí•¨", behavior: "ìƒˆë¡œìš´ ê°€ëŠ¥ì„±ì— ì‰½ê²Œ í¥ë¶„í•˜ëŠ” ì„±í–¥" },
            "ENTP": { strength: "ë…ì°½ì„±ê³¼ ë…¼ìŸ ì¦ê¹€", weakness: "ë°˜ë³µì ì¸ ì—…ë¬´ì— ëŒ€í•œ ì‹«ì¦", behavior: "ê¸°ì¡´ ì²´ê³„ì— ë„ì „í•˜ëŠ” íƒœë„" },
            "ESTJ": { strength: "ê°•ë ¥í•œ ë¦¬ë”ì‹­ê³¼ ì¶”ì§„ë ¥", weakness: "ìœµí†µì„± ì—†ëŠ” ì™„ê³ í•¨", behavior: "ì²´ê³„ì™€ ì§ˆì„œë¥¼ í™•ë¦½í•˜ë ¤ëŠ” ì„±í–¥" },
            "ESFJ": { strength: "í˜‘ë™ì‹¬ê³¼ ì‚¬êµë ¥", weakness: "ë¹„íŒì— ëŒ€í•œ ê³¼ë„í•œ ìƒì²˜", behavior: "ì¡°í™”ë¥¼ ìœ„í•´ ë…¸ë ¥í•˜ëŠ” íƒœë„" },
            "ENFJ": { strength: "ì¹´ë¦¬ìŠ¤ë§ˆì™€ ê³µê° ëŠ¥ë ¥", weakness: "íƒ€ì¸ì˜ ë¬¸ì œì— ì§€ë‚˜ì¹œ ê°œì…", behavior: "íƒ€ì¸ì„ ì´ëŒê³  ì„±ì¥ì‹œí‚¤ë ¤ëŠ” ì„±í–¥" },
            "ENTJ": { strength: "ê²°ë‹¨ë ¥ê³¼ í†µì†”ë ¥", weakness: "ê³¼ì •ë³´ë‹¤ ê²°ê³¼ë¥¼ ì¤‘ì‹œí•˜ëŠ” ì„±ê¸‰í•¨", behavior: "ëª©í‘œë¥¼ í–¥í•´ ì§ì§„í•˜ëŠ” íƒœë„" }
        };

        // --- Advanced Logic: Ship-shin (Ten Gods) Mapping ---
        // 2026 is Fire Year. Day Master -> Fire relationship.
        const SHIP_SHIN_MAP = {
            "wood": { type: "sangsik", name: "ì‹ìƒìš´(é£Ÿå‚·)", keyword: "í‘œí˜„ê³¼ í™œë™", desc: "ë‚˜ì˜ ê¸°ìš´ì„ ë°–ìœ¼ë¡œ í‘œì¶œí•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ì°½ì‘, í™œë™, ì—°ì• ì— ìœ ë¦¬í•©ë‹ˆë‹¤." },
            "fire": { type: "bigyeop", name: "ë¹„ê²ìš´(æ¯”åŠ«)", keyword: "ê²½ìŸê³¼ ìì¡´ê°", desc: "ë‚˜ì™€ ê°™ì€ ì„¸ë ¥ì„ ë§Œë‚˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ì£¼ì²´ì„±ì´ ê°•í•´ì§€ë‚˜ ê²½ìŸì´ ì¹˜ì—´í•©ë‹ˆë‹¤." },
            "earth": { type: "insung", name: "ì¸ì„±ìš´(å°æ˜Ÿ)", keyword: "ë¬¸ì„œì™€ í›„ì›", desc: "ë¶ˆì´ í™ì„ ë‚³ë“¯(í™”ìƒí† ), ë‚˜ë¥¼ ë•ëŠ” ê¸°ìš´ì´ ë“¤ì–´ì˜µë‹ˆë‹¤. ê³„ì•½, í•™ì—…ì— ì¢‹ìŠµë‹ˆë‹¤." },
            "metal": { type: "gwanseong", name: "ê´€ì„±ìš´(å®˜æ˜Ÿ)", keyword: "ì±…ì„ê³¼ ëª…ì˜ˆ", desc: "ë¶ˆì´ ì‡ ë¥¼ ë…¹ì´ë“¯(í™”ê·¹ê¸ˆ), ë‚˜ë¥¼ ê·¹í•˜ëŠ” ê¸°ìš´ì…ë‹ˆë‹¤. ì§ì¥ìš´ê³¼ ëª…ì˜ˆê°€ ë”°ë¥´ë‚˜ ì••ë°•ì´ ì‹¬í•©ë‹ˆë‹¤." },
            "water": { type: "jaeseong", name: "ì¬ì„±ìš´(è²¡æ˜Ÿ)", keyword: "ì¬ë¬¼ê³¼ ê²°ì‹¤", desc: "ë¬¼ì´ ë¶ˆì„ ë„ë“¯(ìˆ˜ê·¹í™”), ë‚´ê°€ ì§€ë°°í•˜ëŠ” ê¸°ìš´ì…ë‹ˆë‹¤. ë…¸ë ¥ì˜ ëŒ€ê°€ì¸ ì¬ë¬¼ì„ ì·¨í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤." }
        };

        // --- Logic ---
        function getHanja(str) {
            if (!str) return "";
            const match = str.match(/\((.)\)/);
            return match ? match[1] : "";
        }

        function isBeforeIpchun(year, month, day) {
            if (month < 2) return true;
            if (month === 2 && day < 4) return true;
            return false;
        }

        function calculateSaju(birthDate, birthTime, gender, location) {
            const date = new Date(birthDate);
            if (isNaN(date.getTime())) throw new Error("ë‚ ì§œ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");

            let year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const [hour, minute] = birthTime.split(':').map(Number);

            let sajuYear = year;
            if (isBeforeIpchun(year, month, day)) sajuYear = year - 1;
            
            const yearGanIndex = (sajuYear - 4) % 10;
            const yearJiIndex = (sajuYear - 4) % 12;

            const refDate = new Date('1900-01-01T00:00:00');
            const targetDate = new Date(year, month - 1, day);
            const diffTime = Math.abs(targetDate - refDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            
            let totalDays = diffDays + 10; 
            let dayGanIndex = totalDays % 10;
            let dayJiIndex = totalDays % 12;

            let totalMinutes = hour * 60 + minute;
            if (location === "Seoul") totalMinutes -= 32; 
            else if (location === "Busan") totalMinutes -= 28; 

            if (totalMinutes < 0) totalMinutes += 1440;
            
            let timeJiIndex = -1;
            let isNextDay = false;
            
            if (totalMinutes >= 1410 || totalMinutes < 90) { 
                timeJiIndex = 0; 
                if (totalMinutes >= 1410) {
                    dayGanIndex = (dayGanIndex + 1) % 10;
                    dayJiIndex = (dayJiIndex + 1) % 12;
                    isNextDay = true;
                }
            } else {
                timeJiIndex = Math.floor((totalMinutes - 90) / 120) + 1;
            }

            const dayGanMod = dayGanIndex % 5;
            const timeGanStart = dayGanMod * 2; 
            const timeGanIndex = (timeGanStart + timeJiIndex) % 10;
            
            let sajuMonth = month;
            if (day < 6) sajuMonth -= 1;
            if (sajuMonth < 1) sajuMonth = 12;

            const yearGanMod = yearGanIndex % 5;
            const monthGanStart = (yearGanMod * 2 + 2) % 10;
            let monthGanIndex = (monthGanStart + (sajuMonth - 2)) % 10;
            if (monthGanIndex < 0) monthGanIndex += 10;
            const finalMonthJiIndex = (sajuMonth) % 12;

            const createPillar = (ganIdx, jiIdx) => {
                const ganStr = CELESTIAL_STEMS[ganIdx];
                const jiStr = EARTHLY_BRANCHES[jiIdx];
                const ganHanja = getHanja(ganStr);
                const jiHanja = getHanja(jiStr);
                return {
                    gan: ganStr, ji: jiStr,
                    ganElem: FIVE_ELEMENTS[ganHanja] || "wood", 
                    jiElem: FIVE_ELEMENTS[jiHanja] || "wood"
                };
            };

            return {
                year: createPillar(yearGanIndex, yearJiIndex),
                month: createPillar((monthGanIndex + 10)%10, finalMonthJiIndex),
                day: createPillar(dayGanIndex, dayJiIndex),
                time: createPillar(timeGanIndex, timeJiIndex),
                isYaJaSi: isNextDay
            };
        }

        function analyzeElements(pillars) {
            const counts = { wood: 0, fire: 0, earth: 0, metal: 0, water: 0 };
            const list = [pillars.year, pillars.month, pillars.day, pillars.time];
            list.forEach(p => {
                if (counts[p.ganElem] !== undefined) counts[p.ganElem]++;
                if (counts[p.jiElem] !== undefined) counts[p.jiElem]++;
            });
            return counts;
        }

        // --- Components ---

        const IntroScreen = ({ onStart }) => (
            <div className="flex flex-col items-center justify-center h-screen text-center px-4 fade-in z-10 relative">
                <div className="orb mb-8"></div>
                <h1 className="text-4xl md:text-5xl font-serif font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-green-300 via-green-100 to-green-300 glow-text">
                    The Oracle
                </h1>
                <p className="text-green-100/80 mb-8 max-w-md font-light leading-relaxed">
                    ìš´ëª…ì€ ì •í•´ì§„ ê²ƒì´ ì•„ë‹ˆë¼, ë°œê²¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.<br/>
                    ë‹¹ì‹ ì˜ ì‚¬ì£¼(Time)ì™€ ì„±í–¥(Type)ì„ í†µí•´<br/>
                    2026ë…„ ë‹¤ê°€ì˜¬ íë¦„ì„ ì½ì–´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
                </p>
                <button onClick={onStart} className="glass-btn px-8 py-3 rounded-full text-green-200 font-medium tracking-widest uppercase hover:text-white">
                    ë¯¸ë˜ ë“¤ì—¬ë‹¤ë³´ê¸°
                </button>
            </div>
        );

        const InputScreen = ({ onSubmit }) => {
            const [formData, setFormData] = useState({ name: '', birthDate: '', birthTime: '', location: 'Seoul', mbti: '' });

            const handleChange = (e) => setFormData({...formData, [e.target.name]: e.target.value});
            const handleSubmit = (e) => {
                e.preventDefault();
                if(!formData.name || !formData.birthDate || !formData.birthTime || !formData.mbti) {
                    alert("ëª¨ë“  ì •ë³´ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì‹­ì‹œì˜¤.");
                    return;
                }
                onSubmit(formData);
            };

            return (
                <div className="flex flex-col items-center justify-center min-h-screen px-4 py-8 fade-in z-10 relative">
                    <div className="glass-panel p-8 rounded-2xl w-full max-w-md">
                        <h2 className="text-2xl font-serif text-center mb-6 text-green-300">ìš´ëª…ì˜ ì¢Œí‘œ ì…ë ¥</h2>
                        <form onSubmit={handleSubmit} className="space-y-5">
                            <div>
                                <label className="block text-xs text-green-400/70 mb-1 uppercase tracking-wider">ì´ë¦„ (Nickname)</label>
                                <input type="text" name="name" onChange={handleChange} className="glass-input w-full p-3 rounded-lg text-white" placeholder="í™ê¸¸ë™" required />
                            </div>
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-xs text-green-400/70 mb-1 uppercase tracking-wider">ìƒë…„ì›”ì¼</label>
                                    <input type="date" name="birthDate" onChange={handleChange} className="glass-input w-full p-3 rounded-lg text-white" required />
                                </div>
                                <div>
                                    <label className="block text-xs text-green-400/70 mb-1 uppercase tracking-wider">íƒœì–´ë‚œ ì‹œê°„</label>
                                    <input type="time" name="birthTime" onChange={handleChange} className="glass-input w-full p-3 rounded-lg text-white" required />
                                </div>
                            </div>
                            <div>
                                <label className="block text-xs text-green-400/70 mb-1 uppercase tracking-wider">íƒœì–´ë‚œ ì§€ì—­</label>
                                <select name="location" onChange={handleChange} className="glass-input w-full p-3 rounded-lg text-white">
                                    <option value="Seoul">ì„œìš¸/ê²½ê¸° (í‘œì¤€)</option>
                                    <option value="Busan">ë¶€ì‚°/ê²½ë‚¨ (-4ë¶„)</option>
                                    <option value="Global">í•´ì™¸</option>
                                </select>
                            </div>
                            <div>
                                <label className="block text-xs text-green-400/70 mb-1 uppercase tracking-wider">MBTI ìœ í˜•</label>
                                <div className="grid grid-cols-4 gap-2">
                                    {MBTI_TYPES.map(type => (
                                        <button key={type} type="button" onClick={() => setFormData({...formData, mbti: type})}
                                            className={`p-2 rounded text-xs transition-colors ${formData.mbti === type ? 'bg-green-600 text-white shadow-[0_0_10px_#00ff88]' : 'bg-white/5 text-green-100/60 hover:bg-white/10'}`}>
                                            {type}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            <button type="submit" className="glass-btn w-full py-4 rounded-xl text-green-200 font-bold mt-4 tracking-widest">ë¶„ì„ ì‹œì‘</button>
                        </form>
                    </div>
                </div>
            );
        };

        const LoadingScreen = () => {
            const [message, setMessage] = useState("ë³„ì˜ ìœ„ì¹˜ë¥¼ ê³„ì‚°í•˜ëŠ” ì¤‘...");
            useEffect(() => {
                const msgs = ["ìƒë…„ì›”ì¼ì˜ ê¸°ìš´ì„ í•´ë…í•˜ëŠ” ì¤‘...", "ì§„íƒœì–‘ì‹œ(çœå¤ªé™½æ™‚) ì˜¤ì°¨ë¥¼ ë³´ì •í•˜ëŠ” ì¤‘...", "2026ë…„ ë³‘ì˜¤ë…„(ä¸™åˆå¹´)ì˜ í™”ê¸°ë¥¼ ë¶„ì„í•˜ëŠ” ì¤‘...", "ë‹¹ì‹ ì˜ ì„±í–¥ê³¼ ìš´ëª…ì˜ êµì°¨ì ì„ ì°¾ëŠ” ì¤‘..."];
                let i = 0;
                const interval = setInterval(() => { setMessage(msgs[i]); i = (i + 1) % msgs.length; }, 1500);
                return () => clearInterval(interval);
            }, []);

            return (
                <div className="flex flex-col items-center justify-center h-screen fade-in z-10 relative">
                    <div className="relative">
                        <div className="orb w-32 h-32 animate-pulse"></div>
                        <div className="absolute top-0 left-0 w-full h-full border-t-2 border-green-400 rounded-full animate-spin"></div>
                    </div>
                    <p className="mt-8 text-green-200 font-serif text-lg animate-pulse">{message}</p>
                </div>
            );
        };

        const ResultScreen = ({ data, onReset }) => {
            const [activeTab, setActiveTab] = useState('total');
            if (!data || !data.pillars) return null;

            const { name, mbti, pillars, elements } = data;
            const myDayElem = pillars.day.ganElem || 'wood'; // User's element
            const mbtiInfo = MBTI_TRAITS[mbti] || MBTI_TRAITS["ISTJ"];
            const myElemName = ELEMENT_NAMES[myDayElem] || "ë¯¸ì§€";
            
            // --- Advanced Calculation ---
            const shipShin = SHIP_SHIN_MAP[myDayElem]; // Determine Ten Gods relationship
            
            // Check for Special Events (Hap/Chung)
            const branches = [pillars.year.ji, pillars.month.ji, pillars.day.ji, pillars.time.ji];
            // 2026 is Horse (åˆ).
            const hasRat = branches.some(b => b.includes('ì')); // Child-Horse Clash (ìì˜¤ì¶©)
            const hasSheep = branches.some(b => b.includes('ë¯¸')); // Horse-Sheep Combination (ì˜¤ë¯¸í•©)
            const hasTigerOrDog = branches.some(b => b.includes('ì¸') || b.includes('ìˆ ')); // Fire Alliance (ì¸ì˜¤ìˆ )

            let specialEventText = "";
            let specialEventTitle = "";
            
            if (hasRat) {
                specialEventTitle = "âš¡ ìì˜¤ì¶©(å­åˆå†²) ë°œìƒ";
                specialEventText = "ì˜¬í•´ëŠ” 'ì¶©ëŒ'ê³¼ 'ë³€ë™'ì˜ ê¸°ìš´ì´ ê°•í•©ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì‚¬ì£¼ì— ìˆëŠ” 'ì¥(Child)'ì™€ 2026ë…„ì˜ 'ë§(Horse)'ì´ ì •ë©´ìœ¼ë¡œ ë¶€ë”ªí™ë‹ˆë‹¤. ì´ëŠ” ì£¼ê±°ì§€ ì´ë™, ì´ì§, í˜¹ì€ ê¸°ì¡´ ê´€ê³„ì˜ ê¸‰ê²©í•œ ë³€í™”ë¥¼ ì•”ì‹œí•©ë‹ˆë‹¤. ë³€í™”ë¥¼ ë‘ë ¤ì›Œí•˜ê¸°ë³´ë‹¤ ëŠ¥ë™ì ìœ¼ë¡œ ë¦¬ì…‹í•˜ëŠ” ê³„ê¸°ë¡œ ì‚¼ìœ¼ì„¸ìš”.";
            } else if (hasTigerOrDog) {
                specialEventTitle = "ğŸ”¥ ì¸ì˜¤ìˆ  í™”êµ­(ç«å±€) í˜•ì„±";
                specialEventText = "ì‚¬ì£¼ì— ë¶ˆì˜ ê¸°ìš´ì„ ë•ëŠ” ê¸€ìê°€ ìˆì–´, 2026ë…„ì˜ í™”(Fire) ê¸°ìš´ì´ í­ë°œì ìœ¼ë¡œ ì¦í­ë©ë‹ˆë‹¤. ì¶”ì§„ë ¥ì´ ê·¹ëŒ€í™”ë˜ì§€ë§Œ, ê³¼ì†ìœ¼ë¡œ ì¸í•œ íƒˆì§„ì´ë‚˜ ì‹¤ìˆ˜ë¥¼ ì¡°ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ë©ˆì¶”ì§€ ì•ŠëŠ” ê¸°ê´€ì°¨ì™€ ê°™ìŠµë‹ˆë‹¤.";
            } else if (hasSheep) {
                specialEventTitle = "ğŸ¤ ì˜¤ë¯¸ ìœ¡í•©(å…­åˆ)";
                specialEventText = "2026ë…„ì˜ ë§(Horse)ì´ ë‹¹ì‹ ì˜ ì–‘(Sheep)ê³¼ í•©ì„ ì´ë£¨ì–´ ì•ˆì •ì„ ì°¾ìŠµë‹ˆë‹¤. ì£¼ë³€ì˜ ë„ì›€ì„ ë°›ê±°ë‚˜ í˜‘ë ¥ ê´€ê³„ê°€ ë‹¨ë‹¨í•´ì§€ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ê°ˆë“±ì´ í•´ì†Œë˜ê³  í‰í™”ë¡œìš´ íë¦„ì´ ì˜ˆìƒë©ë‹ˆë‹¤.";
            }

            const getMonthlyKeywords = () => {
                // Seasonal flow adjusted by Ten Gods
                let spring, summer, autumn, winter;
                
                // Spring (Wood) / Summer (Fire) / Autumn (Metal) / Winter (Water)
                // Relationship depends on My Day Element
                if (myDayElem === 'wood') {
                    // Spring(Wood=Bigyeop), Summer(Fire=Sangsik), Autumn(Metal=Gwan), Winter(Water=Insung)
                    spring = "ë¹„ê²ìš´ - ë™ë£Œì™€ ê²½ìŸí•˜ë©° ì„±ì¥"; summer = "ì‹ìƒìš´ - í™œë™ë ¥ í­ë°œ, í‘œí˜„ì˜ ì‹œê¸°"; autumn = "ê´€ì„±ìš´ - ì§ì¥ ë‚´ í‰ê°€ì™€ ì••ë°•"; winter = "ì¸ì„±ìš´ - íœ´ì‹ê³¼ ì¶©ì „, ë¬¸ì„œ ê³„ì•½";
                } else if (myDayElem === 'fire') {
                    spring = "ì¸ì„±ìš´ - ê·€ì¸ì˜ ë„ì›€ê³¼ ë°°ì›€"; summer = "ë¹„ê²ìš´ - ì£¼ì²´ì„± í™•ë¦½, ë…ë‹¨ ì£¼ì˜"; autumn = "ì¬ì„±ìš´ - ë…¸ë ¥ì˜ ê²°ì‹¤, ì¬ë¬¼ íšë“"; winter = "ê´€ì„±ìš´ - ëª…ì˜ˆ ìƒìŠ¹ê³¼ ì±…ì„ê°";
                } else if (myDayElem === 'earth') {
                    spring = "ê´€ì„±ìš´ - ì¡°ì§ ë‚´ ìë¦¬ ë³€ë™"; summer = "ì¸ì„±ìš´ - ìê²©ì¦ ì·¨ë“, ë¬¸ì„œ ìš´"; autumn = "ì‹ìƒìš´ - ì°½ì˜ì  ì•„ì´ë””ì–´ ë°œì‚°"; winter = "ì¬ì„±ìš´ - ê¸ˆì „ íë¦„ ì›í™œ";
                } else if (myDayElem === 'metal') {
                    spring = "ì¬ì„±ìš´ - íˆ¬ì ê¸°íšŒ, ì§€ì¶œ ê´€ë¦¬"; summer = "ê´€ì„±ìš´ - ìŠ¹ì§„ ê¸°íšŒ í˜¹ì€ ê³¼ë¡œ"; autumn = "ë¹„ê²ìš´ - ì‚¬ëŒë“¤ê³¼ì˜ í˜‘ì—…"; winter = "ì‹ìƒìš´ - ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ì‹œì‘";
                } else { // water
                    spring = "ì‹ìƒìš´ - ìƒˆë¡œìš´ ì‹œì‘ê³¼ ë„ì „"; summer = "ì¬ì„±ìš´ - í° ì¬ë¬¼ì„ ë‹¤ë£¨ëŠ” ê¸°íšŒ"; autumn = "ì¸ì„±ìš´ - ë‚´ì‹¤ ë‹¤ì§€ê¸°, ê³„ì•½"; winter = "ë¹„ê²ìš´ - ì£¼ë„ê¶Œ ì¡ê¸°, ë…ë¦½";
                }
                
                return [
                    { season: "ë´„ (2~4ì›”)", text: spring, detail: "ìƒˆë¡œìš´ ê¸°ìš´ì´ ì‹¹íŠ¸ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. 2026ë…„ì˜ ì‹œì‘ì„ ì•Œë¦¬ëŠ” ì‹ í˜¸íƒ„ì„ ì–´ë–»ê²Œ ì˜ì•„ì˜¬ë¦´ì§€ ê²°ì •í•˜ì„¸ìš”." },
                    { season: "ì—¬ë¦„ (5~7ì›”)", text: summer, detail: "ë³‘ì˜¤ë…„ì˜ í™”ê¸°(Fire)ê°€ ê°€ì¥ ê°•ë ¥í•´ì§€ëŠ” êµ¬ê°„ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì‚¬ì£¼ íë¦„ì—ì„œ ê°€ì¥ ì—­ë™ì ì¸ ì‚¬ê±´ì´ ë°œìƒí•  ê²ƒì…ë‹ˆë‹¤." },
                    { season: "ê°€ì„ (8~10ì›”)", text: autumn, detail: "ëœ¨ê±°ìš´ ì—´ê¸°ê°€ ì‹ì–´ê°€ë©° ê²°ê³¼ê°€ ë“œëŸ¬ë‚©ë‹ˆë‹¤. ìƒë°˜ê¸°ì— ë²Œë ¤ë†“ì€ ì¼ë“¤ì„ ìˆ˜í™•í•˜ê³  ì •ë¦¬í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤." },
                    { season: "ê²¨ìš¸ (11~1ì›”)", text: winter, detail: "ë‹¤ìŒ í•´ë¥¼ ì¤€ë¹„í•˜ë©° ì—ë„ˆì§€ë¥¼ ë¹„ì¶•í•´ì•¼ í•©ë‹ˆë‹¤. ëƒ‰ì² í•œ íŒë‹¨ë ¥ìœ¼ë¡œ í•œ í•´ë¥¼ ë³µê¸°í•˜ì„¸ìš”." }
                ];
            };

            const getDetailedAdvice = (topic) => {
                let context = "", conflict = "", mbtiReaction = "", solution = "";
                const tenGod = shipShin; // {type, name, keyword, desc}

                if (topic === "total") {
                    context = `2026ë…„ ë³‘ì˜¤ë…„ì€ ë‹¹ì‹ ì—ê²Œ **'${tenGod.name}'**ì˜ í•´ì…ë‹ˆë‹¤. ì´ëŠ” **${tenGod.keyword}**ì´(ê°€) ì¸ìƒì˜ ì¤‘ì‹¬ í…Œë§ˆê°€ ë¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ${tenGod.desc}`;
                    if (specialEventTitle) {
                        context += `\n\në˜í•œ ì‚¬ì£¼ ì›êµ­ì—ì„œ **[${specialEventTitle}]** í˜„ìƒì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ${specialEventText}`;
                    }
                    
                    conflict = `ìš´ì„¸ì˜ ì—ë„ˆì§€ê°€ ê°•í•œ ë§Œí¼ ë¶€ì‘ìš©ë„ ë”°ë¦…ë‹ˆë‹¤. '${tenGod.keyword}'ì— ë„ˆë¬´ ëª°ì…í•˜ì—¬ ê· í˜•ì„ ìƒì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. `;
                    if (tenGod.type === 'bigyeop') conflict += "ìì¡´ì‹¬ì´ ê°•í•´ì ¸ ì£¼ë³€ê³¼ ë§ˆì°°ì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    else if (tenGod.type === 'sangsik') conflict += "ë§ ì‹¤ìˆ˜ê°€ ë”°ë¥´ê±°ë‚˜ ì²´ë ¥ì´ ê³ ê°ˆë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    else if (tenGod.type === 'jaeseong') conflict += "ì¬ë¬¼ì„ ì«“ë‹¤ ê±´ê°•ì´ë‚˜ ì¸ê°„ê´€ê³„ë¥¼ ë†“ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    else if (tenGod.type === 'gwanseong') conflict += "ê³¼ë„í•œ ì—…ë¬´ì™€ ì±…ì„ê°ìœ¼ë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ê°€ ê·¹ì— ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    else if (tenGod.type === 'insung') conflict += "ìƒê°ë§Œ í•˜ë‹¤ê°€ í–‰ë™í•˜ì§€ ì•Šê³  ê²Œì„ëŸ¬ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";

                    mbtiReaction = `ë‹¹ì‹ ì˜ MBTI ìœ í˜•ì¸ **${mbti}**ëŠ” **${mbtiInfo.behavior}**í•˜ëŠ” ê²½í–¥ì´ ìˆì£ . 2026ë…„ì˜ ê±°ì„¼ íë¦„ ì†ì—ì„œ ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ìœ¼ë©´ **'${mbtiInfo.weakness}'**í•˜ëŠ” ë‹¨ì ì´ ë“œëŸ¬ë‚˜ ìƒí™©ì„ ì•…í™”ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
                    
                    solution = `[ì˜ˆì–¸ìì˜ ì¡°ì–¸]\nìš´ëª…ì€ íŒŒë„ì™€ ê°™ê³ , ë‹¹ì‹ ì€ ì„œí¼ì…ë‹ˆë‹¤. 2026ë…„ì´ë¼ëŠ” íŒŒë„ì˜ ë†’ì´ëŠ” ë†’ì§€ë§Œ, ë‹¹ì‹ ì˜ **'${mbtiInfo.strength}'**ì„(ë¥¼) ë³´ë“œ ì‚¼ì•„ íƒ„ë‹¤ë©´ ë©‹ì§€ê²Œ ë„˜ì–´ì„¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ${mbti.includes('J') ? 'ìœ ì—°í•¨ì„ ê¸°ë¥´ì„¸ìš”.' : 'ëˆê¸°ë¥¼ ê°€ì§€ì„¸ìš”.'} ì˜¬í•´ëŠ” ë‹¹ì‹ ì´ ì£¼ë„ê¶Œì„ ì¥ì–´ì•¼ í•©ë‹ˆë‹¤.`;
                
                } else if (topic === "wealth") {
                    if (tenGod.type === 'jaeseong') {
                        context = "ì¬ë¬¼ìš´ì´ ì •ì ì— ë‹¬í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ë…¸ë ¥í•œ ë§Œí¼, í˜¹ì€ ê·¸ ì´ìƒì˜ ë³´ìƒì´ ë”°ë¦…ë‹ˆë‹¤. íˆ¬ìì˜ ê°ê°ì´ ì˜ˆë¦¬í•´ì§‘ë‹ˆë‹¤.";
                        conflict = "í•˜ì§€ë§Œ 'ë¬¼ ë“¤ì–´ì˜¬ ë•Œ ë…¸ ì “ëŠ”ë‹¤'ëŠ” ìƒê°ì— ë¬´ë¦¬í•œ íˆ¬ìë¥¼ í•˜ê±°ë‚˜, ì†Œë¹„ê°€ ê±·ì¡ì„ ìˆ˜ ì—†ì´ ì»¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    } else if (tenGod.type === 'bigyeop') {
                        context = "ëˆì´ ë“¤ì–´ì˜¤ì§€ë§Œ ë‚˜ê°ˆ ê³³ë„ ë§ìŠµë‹ˆë‹¤. í˜•ì œ, ë™ë£Œ, ì¹œêµ¬ë“¤ê³¼ ëˆì„ ë‚˜ëˆ„ê±°ë‚˜ ê²½ìŸí•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ìƒê¹ë‹ˆë‹¤.";
                        conflict = "ë³´ì¦ì´ë‚˜ ëˆ ê±°ë˜ëŠ” ì ˆëŒ€ ê¸ˆë¬¼ì…ë‹ˆë‹¤. ì‚¬ëŒì„ ë¯¿ì—ˆë‹¤ê°€ ì¬ë¬¼ì„ ìƒì„ ìˆ˜ ìˆëŠ” ìš´ì…ë‹ˆë‹¤.";
                    } else {
                        context = "ì¬ë¬¼ë³´ë‹¤ëŠ” ëª…ì˜ˆë‚˜ ë¬¸ì„œê°€ ì¤‘ìš”í•œ í•´ì…ë‹ˆë‹¤. í˜„ê¸ˆ íë¦„ì€ í‰ì´í•˜ë‚˜, ìì‚° ê°€ì¹˜ëŠ” ë³€ë™ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                        conflict = "ë‹¹ì¥ ì†ì— ì¥ì–´ì§€ëŠ” í˜„ê¸ˆì´ ì ì–´ ì¡°ê¸‰í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    }
                    mbtiReaction = mbti.includes('P') ? `ì¦‰í¥ì ì¸ ${mbti}ì˜ ì„±í–¥ìƒ ì¶©ë™êµ¬ë§¤ë‚˜ ê¸°ë¶„íŒŒ ì§€ì¶œì„ íŠ¹íˆ ê²½ê³„í•´ì•¼ í•©ë‹ˆë‹¤.` : `ê³„íšì ì¸ ${mbti}ë¼ë„ ì˜¬í•´ëŠ” ì˜ˆìƒì¹˜ ëª»í•œ ì§€ì¶œì— ë‹¹í™©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¹„ìƒê¸ˆì„ í™•ë³´í•˜ì„¸ìš”.`;
                    solution = "ì˜¬í•´ëŠ” 'ê³µê²©ì ì¸ íˆ¬ì'ë³´ë‹¤ëŠ” 'ë°©ì–´ì ì¸ ì €ì¶•'ì´ ìœ ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ë¬¸ì„œ(ë¶€ë™ì‚°, ì£¼ì‹) í˜•íƒœë¡œ ë¬¶ì–´ë‘ëŠ” ê²ƒì´ í˜„ëª…í•©ë‹ˆë‹¤.";

                } else if (topic === "career") {
                    if (tenGod.type === 'gwanseong') {
                        context = "ìŠ¹ì§„, ì·¨ì—…, í•©ê²©ìš´ì´ ë§¤ìš° ê°•í•©ë‹ˆë‹¤. ì¡°ì§ì—ì„œ ëŠ¥ë ¥ì„ ì¸ì •ë°›ê³  ë¦¬ë”ì˜ ìë¦¬ì— ì˜¤ë¥¼ ê¸°íšŒê°€ ì˜µë‹ˆë‹¤.";
                        conflict = "ì™•ê´€ì˜ ë¬´ê²Œë¥¼ ê²¬ëŒì•¼ í•©ë‹ˆë‹¤. ì—…ë¬´ ê°•ë„ê°€ ì„¸ì§€ê³  ìƒì‚¬ì˜ ì••ë°•ì´ ì‹¬í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    } else if (tenGod.type === 'sangsik') {
                        context = "ì§ì¥ ìƒí™œë³´ë‹¤ëŠ” ë‚´ ì‚¬ì—…ì´ë‚˜ í”„ë¦¬ëœì„œ í™œë™, í˜¹ì€ ì´ì§ì„ ê¿ˆê¾¸ê²Œ ë©ë‹ˆë‹¤. ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ê°€ ìƒ˜ì†ŸìŠµë‹ˆë‹¤.";
                        conflict = "ê¸°ì¡´ ì§ˆì„œì— ë°˜í•­í•˜ê³  ì‹¶ì€ ë§ˆìŒì´ ì»¤ì ¸ ìƒì‚¬ì™€ ì¶©ëŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 'í•˜ê·¹ìƒ'ì„ ì¡°ì‹¬í•˜ì„¸ìš”.";
                    } else {
                        context = "í˜„ì¬ì˜ ìë¦¬ë¥¼ ì§€í‚¤ë©° ë‚´ì‹¤ì„ ë‹¤ì§€ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. í° ë³€ë™ë³´ë‹¤ëŠ” ì•ˆì •ì„ ì¶”êµ¬í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.";
                        conflict = "ì§€ë£¨í•¨ì„ ëŠë‚„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë³µë˜ëŠ” ì¼ìƒì— ë§¤ë„ˆë¦¬ì¦˜ì´ ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    }
                    mbtiReaction = mbti.includes('T') ? `ì¼ ì¤‘ì‹¬ì ì¸ ${mbti} ì„±í–¥ì´ ì„±ê³¼ë¥¼ ë‚´ëŠ” ë°ëŠ” ìœ ë¦¬í•˜ì§€ë§Œ, ì¸ê°„ê´€ê³„ë¥¼ ë†“ì³ ì ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.` : `ê´€ê³„ ì¤‘ì‹¬ì ì¸ ${mbti} ì„±í–¥ì´ ì¡°ì§ ìƒí™œì— ìœ¤í™œìœ ê°€ ë˜ì§€ë§Œ, ê±°ì ˆì„ ëª»í•´ ì´ìš©ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
                    solution = "ëŠ¥ë ¥ì€ ë“œëŸ¬ë‚´ë˜, ê³µì€ ë™ë£Œì—ê²Œ ëŒë¦¬ì‹­ì‹œì˜¤. ì˜¬í•´ì˜ í‰íŒì´ í–¥í›„ 3ë…„ì„ ì¢Œìš°í•©ë‹ˆë‹¤.";

                } else if (topic === "love") {
                    if (tenGod.type === 'jaeseong' || tenGod.type === 'gwanseong') {
                        context = "ì´ì„±ìš´ì´ ë§¤ìš° ì¢‹ìŠµë‹ˆë‹¤. ë‚¨ì„±ì—ê²ŒëŠ” ì¬ì„±(ì—¬ì„±), ì—¬ì„±ì—ê²ŒëŠ” ê´€ì„±(ë‚¨ì„±)ì´ ë“¤ì–´ì˜¤ëŠ” í•´ì…ë‹ˆë‹¤. ê²°í˜¼ì´ë‚˜ ì§„ì§€í•œ ë§Œë‚¨ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.";
                        conflict = "ì¸ê¸°ê°€ ë§ì•„ì§€ëŠ” ë§Œí¼ êµ¬ì„¤ìˆ˜ì— ì˜¤ë¥´ê±°ë‚˜, ì–‘ë‹¤ë¦¬ ë“± ë³µì¡í•œ ê´€ê³„ì— ì–½í ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    } else if (tenGod.type === 'sangsik') {
                        context = "ë‚˜ì˜ ë§¤ë ¥ì„ ë°œì‚°í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ì ê·¹ì ìœ¼ë¡œ í‘œí˜„í•˜ë‹ˆ ì—°ì•  ê¸°íšŒê°€ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.";
                        conflict = "í•˜ì§€ë§Œ ë§ºê³  ëŠìŒì´ í™•ì‹¤í•˜ì§€ ì•Šì•„ ì˜¤í•´ë¥¼ ì‚´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ì • ê¸°ë³µì´ ì‹¬í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    } else {
                        context = "ì—°ì• ë³´ë‹¤ëŠ” ë‚˜ì˜ ì¼ì´ë‚˜ ì·¨ë¯¸ê°€ ë” ì¦ê±°ìš´ ì‹œê¸°ì…ë‹ˆë‹¤. ìì—°ìŠ¤ëŸ¬ìš´ ë§Œë‚¨ì„ ê¸°ëŒ€í•˜ì„¸ìš”.";
                        conflict = "ì—°ì¸ì´ ìˆë‹¤ë©´ ì†Œí™€í•´ì§€ê¸° ì‰¬ì›Œ ë‹¤íˆ¼ì´ ì˜ˆìƒë©ë‹ˆë‹¤.";
                    }
                    mbtiReaction = mbti.includes('E') ? "ë„ˆë¬´ ë§ì€ ëª¨ì„ê³¼ ë§Œë‚¨ì´ ì˜¤íˆë ¤ ì§„ì •í•œ ì¸ì—°ì„ ê°€ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤." : "ì§‘ì—ë§Œ ìˆìœ¼ë ¤ëŠ” ${mbti}ì˜ ì„±í–¥ì„ ì´ê²¨ë‚´ê³  ë°–ìœ¼ë¡œ ë‚˜ê°€ì•¼ ìš´ì„ ë§Œë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    solution = "í™”ë ¤í•œ ê²‰ëª¨ìŠµë³´ë‹¤ ëŒ€í™”ê°€ í†µí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. ì˜¬í•´ ë§Œë‚˜ëŠ” ì‚¬ëŒì€ ë‹¹ì‹ ì˜ ê°€ì¹˜ê´€ì„ ê³µìœ í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ì–´ì•¼ í•©ë‹ˆë‹¤.";
                
                } else if (topic === "health") {
                    context = "í™”(Fire) ê¸°ìš´ì´ ê°•í•œ í•´ì´ë¯€ë¡œ, ì‹¬ì¥, í˜ˆì••, ëˆˆ ê±´ê°•ì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ì—´ì´ ìœ„ë¡œ ì†Ÿêµ¬ì¹˜ëŠ” ì¦ìƒì´ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    if (myDayElem === 'water') context += " íŠ¹íˆ ìˆ˜(Water) ê¸°ìš´ì´ ì•½í•œ ë‹¹ì‹ ì€ ì‹ ì¥ê³¼ ë°©ê´‘ ê³„í†µì„ ì‹ ê²½ ì¨ì•¼ í•©ë‹ˆë‹¤.";
                    if (myDayElem === 'metal') context += " íŠ¹íˆ ê¸ˆ(Metal) ê¸°ìš´ì´ ì•½í•œ ë‹¹ì‹ ì€ íì™€ í˜¸í¡ê¸°, í”¼ë¶€ íŠ¸ëŸ¬ë¸”ì„ ì¡°ì‹¬í•˜ì„¸ìš”.";
                    conflict = "ìŠ¤íŠ¸ë ˆìŠ¤ë¡œ ì¸í•œ í™”ë³‘ì´ë‚˜ ë¶ˆë©´ì¦ì´ ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                    mbtiReaction = `ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ìœ¼ë©´ ${mbtiInfo.weakness}í•˜ëŠ” ìŠµê´€ì´ ê±´ê°•ì„ í•´ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
                    solution = "ë¬¼(Water)ì„ ê°€ê¹Œì´ í•˜ì„¸ìš”. ìˆ˜ì˜ì´ë‚˜ ë°˜ì‹ ìš•ì´ ì¢‹ìœ¼ë©°, ë¶‰ì€ìƒ‰ ìŒì‹ë³´ë‹¤ëŠ” ê²€ì€ìƒ‰(ì½©, ê¹¨) ìŒì‹ì„ ì„­ì·¨í•˜ì—¬ ê· í˜•ì„ ë§ì¶”ì„¸ìš”.";
                }

                return { context, conflict, mbtiReaction, solution };
            };

            const tabs = [
                { id: "total", title: "2026 ì´ìš´", icon: "âœ¨" }, { id: "wealth", title: "ì¬ë¬¼ìš´", icon: "ğŸ’°" },
                { id: "career", title: "ì§ì¥ìš´", icon: "ğŸ‘”" }, { id: "love", title: "ì—°ì• ìš´", icon: "â¤ï¸" },
                { id: "health", title: "ê±´ê°•ìš´", icon: "ğŸŒ¿" }, { id: "monthly", title: "ì›”ë³„ íë¦„", icon: "ğŸ“…" }
            ];

            const renderContent = () => {
                if (activeTab === 'monthly') {
                    const months = getMonthlyKeywords();
                    return (
                        <div className="space-y-4 animate-fadeIn">
                            <h3 className="text-xl font-serif text-green-300 mb-4 border-b border-green-500/30 pb-2">2026ë…„ ë³‘ì˜¤ë…„ ê³„ì ˆë³„ íë¦„</h3>
                            <div className="grid gap-4">
                                {months.map((m, idx) => (
                                    <div key={idx} className="bg-black/40 p-4 rounded-lg border border-green-500/10 hover:border-green-500/30 transition-colors">
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="text-green-400 font-bold">{m.season}</span>
                                            <span className="text-xs text-green-200/60 bg-green-900/30 px-2 py-1 rounded">{m.text.split('-')[0]}</span>
                                        </div>
                                        <p className="text-green-100/90 text-sm font-bold mb-1">{m.text.split('-')[1]}</p>
                                        <p className="text-gray-400 text-xs leading-relaxed">{m.detail}</p>
                                    </div>
                                ))}
                            </div>
                        </div>
                    );
                }
                const advice = getDetailedAdvice(activeTab);
                return (
                    <div className="space-y-6 text-green-50 animate-fadeIn text-justify">
                        <section><h4 className="text-green-400 text-sm font-bold uppercase tracking-wider mb-2">The Flow (ìš´ì„¸ì˜ íë¦„)</h4><p className="font-light leading-7 opacity-90 whitespace-pre-wrap">{advice.context}</p></section>
                        <section className="bg-red-900/10 p-4 rounded-lg border border-red-500/10"><h4 className="text-red-300 text-sm font-bold uppercase tracking-wider mb-2">Conflict (ìœ„ê¸°ì™€ ê°ˆë“±)</h4><p className="font-light leading-7 opacity-90">{advice.conflict}</p></section>
                        <section><h4 className="text-blue-300 text-sm font-bold uppercase tracking-wider mb-2">Your Tendency ({mbti} ë¶„ì„)</h4><p className="font-light leading-7 opacity-90">{advice.mbtiReaction}</p></section>
                        <section className="bg-green-500/10 p-5 rounded-xl border border-green-500/30"><h4 className="text-green-300 text-sm font-bold uppercase tracking-wider mb-2">Oracle's Solution (í–‰ë™ ì§€ì¹¨)</h4><p className="font-medium leading-7 text-green-50">{advice.solution}</p></section>
                    </div>
                );
            };

            return (
                <div className="min-h-screen flex flex-col items-center p-4 py-8 fade-in pb-20 z-10 relative">
                    <div className="w-full max-w-3xl flex justify-between items-center mb-6">
                        <h2 className="text-2xl font-serif text-green-300 glow-text">The Oracle</h2>
                        <button onClick={onReset} className="text-xs text-green-400/60 hover:text-green-300 underline underline-offset-4">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
                    </div>
                    <div className="glass-panel w-full max-w-3xl p-0 rounded-3xl mb-6 relative overflow-hidden flex flex-col md:flex-row min-h-[600px]">
                        <div className="w-full md:w-24 bg-black/20 md:border-r border-b md:border-b-0 border-green-500/10 flex md:flex-col justify-around md:justify-start md:pt-8 p-2">
                            {tabs.map((tab) => (
                                <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={`flex flex-col items-center justify-center p-3 rounded-xl transition-all mb-2 ${activeTab === tab.id ? 'bg-green-500/20 text-green-300 shadow-[0_0_15px_rgba(0,255,136,0.2)]' : 'text-gray-500 hover:text-green-200 hover:bg-white/5'}`}>
                                    <span className="text-xl mb-1">{tab.icon}</span><span className="text-[10px] font-bold">{tab.title.split(' ')[0]}</span>
                                </button>
                            ))}
                        </div>
                        <div className="flex-1 p-6 md:p-8 overflow-y-auto max-h-[80vh]">
                            <div className="flex items-center justify-between mb-6 border-b border-green-500/20 pb-4">
                                <div><span className="text-xs bg-green-900/50 text-green-300 px-2 py-1 rounded border border-green-500/30">{pillars.day.gan}{pillars.day.ji}ì¼ì£¼</span><span className="ml-2 text-xs bg-blue-900/50 text-blue-300 px-2 py-1 rounded border border-blue-500/30">{mbti}</span></div>
                                <h2 className="text-xl font-bold text-white">{tabs.find(t => t.id === activeTab)?.title}</h2>
                            </div>
                            {renderContent()}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [gameState, setGameState] = useState('INTRO');
            const [userData, setUserData] = useState(null);

            const handleStart = () => setGameState('INPUT');
            const handleReset = () => { setUserData(null); setGameState('INTRO'); };
            const handleInputSubmit = (data) => {
                setGameState('LOADING');
                setTimeout(() => {
                    try {
                        const pillars = calculateSaju(data.birthDate, data.birthTime, data.gender, data.location);
                        const elements = analyzeElements(pillars);
                        setUserData({ ...data, pillars, elements });
                        setGameState('RESULT');
                    } catch (e) { alert("ì˜¤ë¥˜ ë°œìƒ: " + e.message); window.location.reload(); }
                }, 2500);
            };

            return (
                <div className="relative w-full min-h-screen bg-[#050505] text-[#e0ffe0] font-sans overflow-hidden selection:bg-green-500/30">
                    <div className="aurora-bg"></div>
                    {gameState === 'INTRO' && <IntroScreen onStart={handleStart} />}
                    {gameState === 'INPUT' && <InputScreen onSubmit={handleInputSubmit} />}
                    {gameState === 'LOADING' && <LoadingScreen />}
                    {gameState === 'RESULT' && <ResultScreen data={userData} onReset={handleReset} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


